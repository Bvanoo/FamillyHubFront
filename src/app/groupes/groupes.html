<div class="groups-container">
  
  <div class="tabs">
    <button (click)="activeTab.set('my-groups')" [class.active]="activeTab() === 'my-groups'">
      <i class="fa fa-users"></i> Mes Groupes
    </button>
    <button (click)="activeTab.set('search')" [class.active]="activeTab() === 'search'">
      <i class="fa fa-search"></i> Rejoindre
    </button>
    <button (click)="activeTab.set('create')" [class.active]="activeTab() === 'create'">
      <i class="fa fa-plus-circle"></i> Cr√©er
    </button>
  </div>

  <div *ngIf="activeTab() === 'my-groups'" class="tab-content">
    <h2>Mes Communaut√©s</h2>
    
    <div class="card-grid" *ngIf="myGroups().length > 0; else noGroup">
      <div class="card" *ngFor="let group of myGroups()">
        <div class="card-header">{{ group.name }}</div>
        <div class="card-body">
          <p style="font-size: 0.9rem; color: #555;">{{ group.description || 'Pas de description' }}</p>
          <button class="btn-primary" (click)="_nav.goToGroupDetail(group.id)">Entrer dans le groupe</button>
        </div>
      </div>
    </div>

    <ng-template #noGroup>
      <div style="text-align: center; color: #888; padding: 40px;">
        <p>Vous n'avez pas encore de groupe.</p>
        <button (click)="activeTab.set('search')" style="color: #117ebd; background: none; border: none; text-decoration: underline; cursor: pointer;">
          Rejoindre un groupe existant
        </button>
      </div>
    </ng-template>
  </div>

  <div *ngIf="activeTab() === 'search'" class="tab-content">
    <h2>Trouver un groupe</h2>
    <div class="search-bar">
      <input type="text" [(ngModel)]="searchQuery" (keyup.enter)="search()" placeholder="Chercher dans vos groupes...">
      <button (click)="search()">üîç</button>
    </div>
    
<div class="list-results">
  <div *ngFor="let group of randomPublicGroups()" class="result-item">
    
    <div class="result-item-header">
      {{ group.name }}
    </div>

    <div class="result-item-body">
      <p>{{ group.description || 'Pas de description' }}</p>
      <button (click)="joinGroup(group)">Rejoindre</button>
    </div>

  </div>
</div>

    <div *ngIf="!searchQuery" class="random-groups-section" style="margin-top: 20px;">
      <h3 style="color: #4b5563; font-size: 1.1rem; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">‚ú® Groupes publics √† d√©couvrir</h3>
      
      <div class="list-results">
        <div *ngFor="let group of randomPublicGroups()" class="result-item" style="display: flex; justify-content: space-between; align-items: center; padding: 15px; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 10px; background: #f9fafb;">
          <div>
            <strong style="font-size: 1.1rem; color: #1f2937;">{{ group.name }}</strong>
            <div style="font-size: 0.85rem; color: #6b7280; margin-top: 5px;">{{ group.description || 'Pas de description' }}</div>
          </div>
          <button class="btn-primary" (click)="joinGroup(group)" style="padding: 8px 16px;">Rejoindre</button>
        </div>
        
        <p *ngIf="randomPublicGroups().length === 0" style="text-align: center; color: #9ca3af; padding: 20px;">Aucun nouveau groupe public disponible pour le moment.</p>
      </div>
    </div>
  </div>

  <div *ngIf="activeTab() === 'create'" class="tab-content">
    <h2>Cr√©er une nouvelle tribu</h2>

    <div *ngIf="creationError()" style="background-color: #ffebee; color: #c62828; padding: 10px; border-radius: 5px; margin-bottom: 15px; text-align: center; font-weight: bold;">
      ‚ö†Ô∏è {{ creationError() }}
    </div>

    <form (ngSubmit)="createGroup()">
      <div class="form-group">
        <label>Nom du groupe</label>
        <input [(ngModel)]="newGroup.name" name="name" placeholder="Ex: Les Cousins, Club Rando..." required>
      </div>
      <div class="form-group">
        <label>Description</label>
        <textarea [(ngModel)]="newGroup.description" name="desc" placeholder="Quel est le but de ce groupe ?" rows="3"></textarea>
      </div>
      <div class="checkbox-group">
        <label class="checkbox-label">
          <input type="checkbox" [(ngModel)]="newGroup.isPublic" name="public"> 
          <strong>Groupe Public</strong> 
        </label>
      </div>
      <button type="submit" [disabled]="isCreating()" [ngStyle]="{'opacity': isCreating() ? '0.6' : '1', 'cursor': isCreating() ? 'not-allowed' : 'pointer'}">
        {{ isCreating() ? 'Cr√©ation en cours...' : 'Cr√©er le groupe' }}
      </button>
    </form>
  </div>

</div>