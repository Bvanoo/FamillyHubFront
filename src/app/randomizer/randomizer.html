<div class="app">
  <main class="content">
    <header class="header">
      <h1><i class="fas fa-random"></i> Randomizer</h1>
      <button class="btn-primary"><i class="fas fa-history"></i> Historique</button>
    </header>

    <section class="randomizer-layout">
      <div class="card config-window">
        <h2><i class="fas fa-sliders-h"></i> Configuration</h2>
        
        <div class="mode-selector">
          <button class="mode-btn" [class.active]="mode() === 'cacahuete'" (click)="setMode('cacahuete')">
            <span class="icon"><i class="fas fa-user-secret"></i></span>
            <strong>Cacahuète</strong>
            <small>Tirage croisé secret</small>
          </button>
          
          <button class="mode-btn" [class.active]="mode() === 'tache'" (click)="setMode('tache')">
            <span class="icon"><i class="fas fa-tasks"></i></span>
            <strong>Tâche</strong>
            <small>Assigner un élu au hasard</small>
          </button>
        </div>

        <div class="setup-area">
          <div class="input-group">
            <label>Titre de l'événement</label>
            <input type="text" [ngModel]="eventTitle()" (ngModelChange)="eventTitle.set($event)" placeholder="Ex: Noël en famille...">
          </div>
          
          <div class="result-placeholder">
            @if (drawResult()) {
              <p class="winner-text" [class.drawing]="isDrawing()">
                {{ mode() === 'tache' ? 'L\'élu(e) est : ' : 'Simulation...' }} 
                <strong>{{ drawResult() }}</strong> 
              </p>
            } @else {
              <p><i class="fas fa-info-circle"></i> Sélectionnez un groupe et lancez le tirage</p>
            }
          </div>
        </div>

        <button class="btn-primary btn-launch" [disabled]="isDrawing()" (click)="launchDraw()">
          <i class="fas" [class.fa-spinner]="isDrawing()" [class.fa-play]="!isDrawing()" [class.fa-spin]="isDrawing()"></i>
          {{ isDrawing() ? 'Tirage en cours...' : 'Lancer le tirage' }}
        </button>
      </div>

      <div class="card groups-panel">
        <div class="panel-header">
          <h2><i class="fas fa-users"></i> Sélection du groupe</h2>
        </div>

        <div class="groups-selection-area">
          <div class="input-group">
            <label for="group-picker">Groupe actif</label>
            <select id="group-picker" class="group-select" (change)="onGroupChange($event)">
              <option value="" disabled selected>-- Choisir un groupe --</option>
              @for (group of groups; track group.id) {
                <option [value]="group.id">{{ group.name }}</option>
              }
            </select>
          </div>

          <div class="participants-list-container">
            <h3>Membres du groupe ({{ currentMembers.length }})</h3>
            <ul id="participants-list" class="members-display">
              @if (currentMembers.length === 0) {
                <li class="placeholder-text"><i class="fas fa-users-slash"></i> Aucun groupe sélectionné</li>
              } @else {
                @for (member of currentMembers; track member) {
                  <li><i class="fas fa-user"></i> {{ member }}</li>
                }
              }
            </ul>
          </div>
        </div>

        <button class="btn-secondary"><i class="fas fa-user-edit"></i> Gérer les membres</button>
      </div>
    </section>
  </main>
</div>