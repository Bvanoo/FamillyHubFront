<div class="app-container">
  <main class="content-area">
    
    <header class="page-header">
      <h1>ğŸ“… Planning & Dispos</h1>
      <div class="header-actions">
        <button class="btn-secondary">Exporter</button>
        <button class="btn-primary" (click)="saveToDatabase()">Enregistrer tout</button>
      </div>
    </header>

    <section class="calendar-layout">
      
      <aside class="card sidebar-config">
        <div class="config-section">
          <h3>Instructions</h3>
          <p class="instruction-text">
            Cliquez sur un crÃ©neau pour ajouter un Ã©vÃ©nement.
            Glissez pour dÃ©finir la durÃ©e.
          </p>
        </div>

        <div class="config-section status-legend">
          <h3>LÃ©gende</h3>
          <ul>
            <li><span class="badge blue"></span> Groupe (PartagÃ©)</li>
            <li><span class="badge green"></span> Perso (Disponible)</li>
            <li><span class="badge yellow"></span> Perso (PrivÃ©)</li>
            <li><span class="badge red"></span> Perso (MasquÃ©)</li>
          </ul>
        </div>
      </aside>

      <div class="card calendar-card">
        <full-calendar [options]="calendarOptions"></full-calendar>
      </div>
    </section>
  </main>

  <div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
    <div class="card modal-box" (click)="$event.stopPropagation()">

      <div class="modal-header">
        <h2>{{ isEditMode ? 'Modifier l\'Ã©vÃ©nement' : 'Nouvel Ã©vÃ©nement' }}</h2>
      </div>

      <div class="modal-body">
        
        <div class="input-group">
          <label>Titre de l'Ã©vÃ©nement</label>
          <input type="text" class="custom-input" [(ngModel)]="tempEvent.title" placeholder="Ex: Repas de famille, Dentiste...">
        </div>

        <div class="input-group">
          <label>Ajouter au calendrier de :</label>
          <select class="custom-input" [(ngModel)]="tempEvent.groupId">
            <option [ngValue]="null">ğŸ‘¤ Mon Calendrier Personnel</option>
            <option disabled>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</option>
            <option *ngFor="let g of myGroups" [ngValue]="g.id">ğŸ‘¥ {{ g.name }}</option>
          </select>
        </div>

        <div class="input-group" *ngIf="tempEvent.groupId === null">
          <label>ConfidentialitÃ©</label>
          <div class="checkbox-row">
            <label class="checkbox-label" title="Visible uniquement par moi">
              <input type="checkbox" [(ngModel)]="tempEvent.isPrivate"> 
              ğŸ”’ PrivÃ©
            </label>
            <label class="checkbox-label" title="Les autres verront 'OccupÃ©'">
              <input type="checkbox" [(ngModel)]="tempEvent.maskDetails" [disabled]="tempEvent.isPrivate"> 
              ğŸ™ˆ Masquer dÃ©tails
            </label>
          </div>
        </div>

        <div class="color-picker-group">
          <label>Couleur</label>
          
          <div class="color-presets" *ngIf="tempEvent.groupId === null">
            <div class="color-swatch" [style.background-color]="'#3b82f6'" (click)="tempEvent.color = '#3b82f6'" [class.active]="tempEvent.color === '#3b82f6'"></div>
            <div class="color-swatch" [style.background-color]="'#10b981'" (click)="tempEvent.color = '#10b981'" [class.active]="tempEvent.color === '#10b981'"></div>
            <div class="color-swatch" [style.background-color]="'#f59e0b'" (click)="tempEvent.color = '#f59e0b'" [class.active]="tempEvent.color === '#f59e0b'"></div>
            <div class="color-swatch" [style.background-color]="'#ef4444'" (click)="tempEvent.color = '#ef4444'" [class.active]="tempEvent.color === '#ef4444'"></div>
          </div>

          <p *ngIf="tempEvent.groupId !== null" style="font-size:0.9rem; color:#64748b; margin-bottom:10px;">
            â„¹ï¸ Les Ã©vÃ©nements de groupe utilisent la couleur du groupe.
          </p>

          <div class="custom-color-section">
             <input type="color" class="rect-color-input" [(ngModel)]="tempEvent.color" [disabled]="tempEvent.groupId !== null">
          </div>
        </div>

      </div>

      <div class="modal-footer">
        <button *ngIf="isEditMode" class="btn-danger" (click)="deleteEvent()">Supprimer</button>
        <div *ngIf="!isEditMode"></div> <div class="right-actions">
          <button class="btn-cancel" (click)="closeModal()">Annuler</button>
          <button class="btn-primary" (click)="saveEvent()">
            {{ isEditMode ? 'Mettre Ã  jour' : 'Enregistrer' }}
          </button>
        </div>
      </div>

    </div>
  </div>
</div>