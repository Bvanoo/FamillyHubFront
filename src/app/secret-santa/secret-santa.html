<div class="app">
  <main class="content">
    <header class="header">
      <h1>ğŸ… Espace Secret : {{ isGiver() ? 'Cadeau pour ' + targetName() : 'Mon PÃ¨re NoÃ«l' }}</h1>
    </header>

    <div class="santa-grid">
      
      <section class="chat-section card">
        <div class="chat-header">
          <h3>ğŸ’¬ Discussion anonyme</h3>
          <small>{{ isGiver() ? 'Posez des questions sans vous dÃ©voiler' : 'RÃ©pondez Ã  votre PÃ¨re NoÃ«l' }}</small>
        </div>

        <div class="messages-container">
          @for (msg of messages(); track msg.id) {
            <div class="message" [ngClass]="{'mine': msg.senderId === userId, 'others': msg.senderId !== userId}">
              <div class="bubble">
                <span class="sender-label">
                  {{ msg.senderId === userId ? 'Moi' : (isGiver() ? targetName() : 'PÃ¨re NoÃ«l Secret') }}
                </span>
                <p>{{ msg.content }}</p>
                <small>{{ msg.sentAt | date:'HH:mm' }}</small>
              </div>
            </div>
          }
        </div>

        <div class="chat-input">
          <input type="text" [(ngModel)]="newMessage" placeholder="Ã‰crire un message..." (keyup.enter)="sendMessage()">
          <button (click)="sendMessage()" class="btn-send">ğŸš€</button>
        </div>
      </section>

      <section class="wishlist-section card">
        <h3>ğŸ IdÃ©es cadeaux</h3>
        
        @if (isGiver()) {
          <div class="wishlist-display">
            <p>Voici ce que <strong>{{ targetName() }}</strong> aimerait :</p>
            <div class="wishlist-content">
              {{ wishlist() || 'Aucune idÃ©e pour le moment...' }}
            </div>
          </div>
        } @else {
          <div class="wishlist-edit">
            <label>Aidez votre PÃ¨re NoÃ«l en listant vos envies :</label>
            <textarea [(ngModel)]="wishlist" placeholder="Ex: Un livre de cuisine, une plante..."></textarea>
            <button class="btn-primary" (click)="updateWishlist()">Enregistrer mes envies</button>
          </div>
        }
      </section>

    </div>
  </main>
</div>